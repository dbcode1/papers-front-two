{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/dmbru/Code/papers/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/dmbru/Code/papers/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from\"axios\";import{setAlert}from\"./alert\";import store from\"../store\";import\"dotenv/config\";import{REGISTER_SUCCESS,REGISTER_FAIL,USER_LOADED,AUTH_ERROR,LOGIN_SUCCESS,LOGIN_FAIL,LOGOUT,DELETE_USER,SET_ALERT}from\"./types\";import setAuthToken from\"../utils/setAuthToken\";// Load User\nexport var loadUser=function loadUser(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"\".concat(process.env.REACT_APP_API,\"/auth\"));case 3:res=_context.sent;dispatch({type:USER_LOADED,payload:res.data});_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);dispatch({type:AUTH_ERROR});case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function(_x){return _ref.apply(this,arguments);};}();};// Register User\nexport var register=function register(_ref2){var name=_ref2.name,email=_ref2.email,password=_ref2.password;return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var config,body,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:console.log(\"register\");config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({name:name,email:email,password:password});_context2.prev=3;_context2.next=6;return axios.post(\"https://papers-back-382b4d134cec.herokuapp.com/user\",body,config);case 6:res=_context2.sent;dispatch({type:REGISTER_SUCCESS,payload:res.data});dispatch(loadUser());_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](3);alert(_context2.t0.response.data.errors[0].param+\": \"+_context2.t0.response.data.errors[0].msg);dispatch({type:REGISTER_FAIL});case 15:case\"end\":return _context2.stop();}},_callee2,null,[[3,11]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};// Login User\nexport var login=function login(email,password){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var config,body,res;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context3.prev=1;body=JSON.stringify({email:email,password:password});_context3.next=5;return axios.post(\"\".concat(process.env.REACT_APP_API,\"/auth/login\"),body,config);case 5:res=_context3.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(loadUser());_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](1);alert(// err.response.data.errors[0].param + \": \" + err.response.data.errors[0].msg\nconsole.log(_context3.t0));case 13:case\"end\":return _context3.stop();}},_callee3,null,[[1,10]]);}));return function(_x3){return _ref4.apply(this,arguments);};}();};// Logout\nexport var logout=function logout(){return function(dispatch){dispatch({type:LOGOUT});};};// Delete User Account\nexport var deleteUser=function deleteUser(){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var body;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.prev=0;body=store.getState().auth.token;window.confirm(\"Are you sure you want to delete your account\");localStorage.clear();_context4.next=6;return axios.delete(\"\".concat(process.env.REACT_APP_API,\"/user\"),body);case 6:_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](0);alert(_context4.t0.response.data.errors[0].msg);case 11:case\"end\":return _context4.stop();}},_callee4,null,[[0,8]]);}));return function(_x4){return _ref5.apply(this,arguments);};}();};","map":{"version":3,"names":["axios","setAlert","store","REGISTER_SUCCESS","REGISTER_FAIL","USER_LOADED","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","DELETE_USER","SET_ALERT","setAuthToken","loadUser","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","res","wrap","_callee$","_context","prev","next","get","concat","process","env","REACT_APP_API","sent","type","payload","data","t0","stop","_x","apply","arguments","register","_ref2","name","email","password","_ref3","_callee2","config","body","_callee2$","_context2","console","log","headers","JSON","stringify","post","alert","response","errors","param","msg","_x2","login","_ref4","_callee3","_callee3$","_context3","_x3","logout","deleteUser","_ref5","_callee4","_callee4$","_context4","getState","auth","token","window","confirm","localStorage","clear","delete","_x4"],"sources":["C:/Users/dmbru/Code/papers/client/src/actions/auth.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { setAlert } from \"./alert\";\r\nimport store from \"../store\";\r\nimport \"dotenv/config\";\r\n\r\nimport {\r\n  REGISTER_SUCCESS,\r\n  REGISTER_FAIL,\r\n  USER_LOADED,\r\n  AUTH_ERROR,\r\n  LOGIN_SUCCESS,\r\n  LOGIN_FAIL,\r\n  LOGOUT,\r\n  DELETE_USER,\r\n  SET_ALERT,\r\n} from \"./types\";\r\nimport setAuthToken from \"../utils/setAuthToken\";\r\n\r\n// Load User\r\nexport const loadUser = () => async (dispatch) => {\r\n  try {\r\n    const res = await axios.get(`${process.env.REACT_APP_API}/auth`);\r\n\r\n    dispatch({\r\n      type: USER_LOADED,\r\n      payload: res.data,\r\n    });\r\n  } catch (err) {\r\n    dispatch({\r\n      type: AUTH_ERROR,\r\n    });\r\n  }\r\n};\r\n\r\n// Register User\r\nexport const register =\r\n  ({ name, email, password }) =>\r\n  async (dispatch) => {\r\n    console.log(\"register\");\r\n    const config = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    };\r\n\r\n    const body = JSON.stringify({ name, email, password });\r\n\r\n    try {\r\n      const res = await axios.post(\r\n        \"https://papers-back-382b4d134cec.herokuapp.com/user\",\r\n        body,\r\n        config\r\n      );\r\n\r\n      dispatch({\r\n        type: REGISTER_SUCCESS,\r\n        payload: res.data,\r\n      });\r\n      dispatch(loadUser());\r\n    } catch (err) {\r\n      alert(\r\n        err.response.data.errors[0].param +\r\n          \": \" +\r\n          err.response.data.errors[0].msg\r\n      );\r\n\r\n      dispatch({\r\n        type: REGISTER_FAIL,\r\n      });\r\n    }\r\n  };\r\n\r\n// Login User\r\nexport const login = (email, password) => async (dispatch) => {\r\n  const config = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n\r\n  try {\r\n    const body = JSON.stringify({ email, password });\r\n\r\n    const res = await axios.post(\r\n      `${process.env.REACT_APP_API}/auth/login`,\r\n      body,\r\n      config\r\n    );\r\n\r\n    dispatch({\r\n      type: LOGIN_SUCCESS,\r\n      payload: res.data,\r\n    });\r\n\r\n    dispatch(loadUser());\r\n  } catch (err) {\r\n    alert(\r\n      // err.response.data.errors[0].param + \": \" + err.response.data.errors[0].msg\r\n      console.log(err)\r\n    );\r\n  }\r\n};\r\n\r\n// Logout\r\nexport const logout = () => (dispatch) => {\r\n  dispatch({\r\n    type: LOGOUT,\r\n  });\r\n};\r\n\r\n// Delete User Account\r\nexport const deleteUser = () => async (dispatch) => {\r\n  try {\r\n    const body = store.getState().auth.token;\r\n    window.confirm(\"Are you sure you want to delete your account\");\r\n    localStorage.clear();\r\n    await axios.delete(`${process.env.REACT_APP_API}/user`, body);\r\n  } catch (err) {\r\n    alert(err.response.data.errors[0].msg);\r\n  }\r\n};\r\n"],"mappings":"8PAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,KAAQ,SAAS,CAClC,MAAO,CAAAC,KAAK,KAAM,UAAU,CAC5B,MAAO,eAAe,CAEtB,OACEC,gBAAgB,CAChBC,aAAa,CACbC,WAAW,CACXC,UAAU,CACVC,aAAa,CACbC,UAAU,CACVC,MAAM,CACNC,WAAW,CACXC,SAAS,KACJ,SAAS,CAChB,MAAO,CAAAC,YAAY,KAAM,uBAAuB,CAEhD;AACA,MAAO,IAAM,CAAAC,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAA,oCAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAS,SAAAC,QAAOC,QAAQ,MAAAC,GAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAEvB,CAAAzB,KAAK,CAAC0B,GAAG,IAAAC,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,aAAa,SAAO,CAAC,QAA1DV,GAAG,CAAAG,QAAA,CAAAQ,IAAA,CAETZ,QAAQ,CAAC,CACPa,IAAI,CAAE3B,WAAW,CACjB4B,OAAO,CAAEb,GAAG,CAACc,IACf,CAAC,CAAC,CAACX,QAAA,CAAAE,IAAA,iBAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAY,EAAA,CAAAZ,QAAA,aAEHJ,QAAQ,CAAC,CACPa,IAAI,CAAE1B,UACR,CAAC,CAAC,CAAC,yBAAAiB,QAAA,CAAAa,IAAA,MAAAlB,OAAA,gBAEN,mBAAAmB,EAAA,SAAAvB,IAAA,CAAAwB,KAAA,MAAAC,SAAA,UAED;AACA,MAAO,IAAM,CAAAC,QAAQ,CACnB,QADW,CAAAA,QAAQA,CAAAC,KAAA,KAChB,CAAAC,IAAI,CAAAD,KAAA,CAAJC,IAAI,CAAEC,KAAK,CAAAF,KAAA,CAALE,KAAK,CAAEC,QAAQ,CAAAH,KAAA,CAARG,QAAQ,mCAAAC,KAAA,CAAA9B,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CACxB,SAAA6B,SAAO3B,QAAQ,MAAA4B,MAAA,CAAAC,IAAA,CAAA5B,GAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAA4B,UAAAC,SAAA,iBAAAA,SAAA,CAAA1B,IAAA,CAAA0B,SAAA,CAAAzB,IAAA,SACb0B,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC,CACjBL,MAAM,CAAG,CACbM,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAEKL,IAAI,CAAGM,IAAI,CAACC,SAAS,CAAC,CAAEb,IAAI,CAAJA,IAAI,CAAEC,KAAK,CAALA,KAAK,CAAEC,QAAQ,CAARA,QAAS,CAAC,CAAC,CAAAM,SAAA,CAAA1B,IAAA,GAAA0B,SAAA,CAAAzB,IAAA,SAGlC,CAAAzB,KAAK,CAACwD,IAAI,CAC1B,qDAAqD,CACrDR,IAAI,CACJD,MACF,CAAC,QAJK3B,GAAG,CAAA8B,SAAA,CAAAnB,IAAA,CAMTZ,QAAQ,CAAC,CACPa,IAAI,CAAE7B,gBAAgB,CACtB8B,OAAO,CAAEb,GAAG,CAACc,IACf,CAAC,CAAC,CACFf,QAAQ,CAACN,QAAQ,CAAC,CAAC,CAAC,CAACqC,SAAA,CAAAzB,IAAA,kBAAAyB,SAAA,CAAA1B,IAAA,IAAA0B,SAAA,CAAAf,EAAA,CAAAe,SAAA,aAErBO,KAAK,CACHP,SAAA,CAAAf,EAAA,CAAIuB,QAAQ,CAACxB,IAAI,CAACyB,MAAM,CAAC,CAAC,CAAC,CAACC,KAAK,CAC/B,IAAI,CACJV,SAAA,CAAAf,EAAA,CAAIuB,QAAQ,CAACxB,IAAI,CAACyB,MAAM,CAAC,CAAC,CAAC,CAACE,GAChC,CAAC,CAED1C,QAAQ,CAAC,CACPa,IAAI,CAAE5B,aACR,CAAC,CAAC,CAAC,yBAAA8C,SAAA,CAAAd,IAAA,MAAAU,QAAA,iBAEN,mBAAAgB,GAAA,SAAAjB,KAAA,CAAAP,KAAA,MAAAC,SAAA,UAEH;AACA,MAAO,IAAM,CAAAwB,KAAK,CAAG,QAAR,CAAAA,KAAKA,CAAIpB,KAAK,CAAEC,QAAQ,oCAAAoB,KAAA,CAAAjD,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAK,SAAAgD,SAAO9C,QAAQ,MAAA4B,MAAA,CAAAC,IAAA,CAAA5B,GAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAA6C,UAAAC,SAAA,iBAAAA,SAAA,CAAA3C,IAAA,CAAA2C,SAAA,CAAA1C,IAAA,SACjDsB,MAAM,CAAG,CACbM,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAAAc,SAAA,CAAA3C,IAAA,GAGOwB,IAAI,CAAGM,IAAI,CAACC,SAAS,CAAC,CAAEZ,KAAK,CAALA,KAAK,CAAEC,QAAQ,CAARA,QAAS,CAAC,CAAC,CAAAuB,SAAA,CAAA1C,IAAA,SAE9B,CAAAzB,KAAK,CAACwD,IAAI,IAAA7B,MAAA,CACvBC,OAAO,CAACC,GAAG,CAACC,aAAa,gBAC5BkB,IAAI,CACJD,MACF,CAAC,QAJK3B,GAAG,CAAA+C,SAAA,CAAApC,IAAA,CAMTZ,QAAQ,CAAC,CACPa,IAAI,CAAEzB,aAAa,CACnB0B,OAAO,CAAEb,GAAG,CAACc,IACf,CAAC,CAAC,CAEFf,QAAQ,CAACN,QAAQ,CAAC,CAAC,CAAC,CAACsD,SAAA,CAAA1C,IAAA,kBAAA0C,SAAA,CAAA3C,IAAA,IAAA2C,SAAA,CAAAhC,EAAA,CAAAgC,SAAA,aAErBV,KAAK,CACH;AACAN,OAAO,CAACC,GAAG,CAAAe,SAAA,CAAAhC,EAAI,CACjB,CAAC,CAAC,yBAAAgC,SAAA,CAAA/B,IAAA,MAAA6B,QAAA,iBAEL,mBAAAG,GAAA,SAAAJ,KAAA,CAAA1B,KAAA,MAAAC,SAAA,UAED;AACA,MAAO,IAAM,CAAA8B,MAAM,CAAG,QAAT,CAAAA,MAAMA,CAAA,QAAS,UAAClD,QAAQ,CAAK,CACxCA,QAAQ,CAAC,CACPa,IAAI,CAAEvB,MACR,CAAC,CAAC,CACJ,CAAC,GAED;AACA,MAAO,IAAM,CAAA6D,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAA,oCAAAC,KAAA,CAAAxD,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAS,SAAAuD,SAAOrD,QAAQ,MAAA6B,IAAA,QAAAhC,mBAAA,GAAAK,IAAA,UAAAoD,UAAAC,SAAA,iBAAAA,SAAA,CAAAlD,IAAA,CAAAkD,SAAA,CAAAjD,IAAA,SAAAiD,SAAA,CAAAlD,IAAA,GAErCwB,IAAI,CAAG9C,KAAK,CAACyE,QAAQ,CAAC,CAAC,CAACC,IAAI,CAACC,KAAK,CACxCC,MAAM,CAACC,OAAO,CAAC,8CAA8C,CAAC,CAC9DC,YAAY,CAACC,KAAK,CAAC,CAAC,CAACP,SAAA,CAAAjD,IAAA,SACf,CAAAzB,KAAK,CAACkF,MAAM,IAAAvD,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,aAAa,UAASkB,IAAI,CAAC,QAAA0B,SAAA,CAAAjD,IAAA,iBAAAiD,SAAA,CAAAlD,IAAA,GAAAkD,SAAA,CAAAvC,EAAA,CAAAuC,SAAA,aAE7DjB,KAAK,CAACiB,SAAA,CAAAvC,EAAA,CAAIuB,QAAQ,CAACxB,IAAI,CAACyB,MAAM,CAAC,CAAC,CAAC,CAACE,GAAG,CAAC,CAAC,yBAAAa,SAAA,CAAAtC,IAAA,MAAAoC,QAAA,gBAE1C,mBAAAW,GAAA,SAAAZ,KAAA,CAAAjC,KAAA,MAAAC,SAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}